<!DOCTYPE html>
<html lang="en-us">
  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta charset="utf-8">
  <title>Examples of creating base64 hashes using HMAC SHA256 in different languages - Joe Kampschmidt's Code</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="description" content="A list of code examples in various languages that demonstrate how to create base64 hashes using HMAC SHA256. Compare the different coding languages.">
  <meta name="keywords" content="Joe, Computer, .NET, C#, Kampschmidt, blog, jokecamp, code, developer, API" />
  <meta name="author" content="Joe Kampschmidt" />
  <link href='/public/poole.css' rel='stylesheet' type='text/css'>
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
	<link rel="me" type="text/html" href="https://plus.google.com/+JoeKampschmidt?rel=me"/>
	<link rel="me" type="text/html" href="https://twitter.com/jokecamp"/>
</head>

  <body>
    <div class="masthead">
      <div class="container center">
        <a href="/" title="also known as @jokecamp" class="masthead-title">Joe Kampschmidt's Code</a>

        <nav class="nav" role="navigation">
          <ul>
            <li><a class="" href="/blog/" title="Joe's Blog">Blog</a></li><li><a class="" href="/projects/" title="Joe's Projects">Projects</a></li>
            <li><a rel="me" href="https://github.com/jokecamp" title="Joe's github page - commit all the things">Code</a></li>
          </ul>
        </nav>
      </div>
    </div> <!-- end masthead -->

    <div class="container content">

      <div role="main">
        <div class="post">
  <h1 class="post-title">Examples of creating base64 hashes using HMAC SHA256 in different languages</h1>
  <span class="post-date">21 Oct 2012</span>
  <p>I recently went through the processing of creating SDKs for an in house API. The API required signing every REST request with HMAC SHA256 signatures. Those signatures then needed to be converted to base64. Amazon S3 uses base64 strings for their hashes. There are some good reasons to use base64 encoding. See the stackOverflow question <a href="http://stackoverflow.com/a/201510/215502">What is the use of base 64 encoding?</a></p>

<p>Below are some simplified HMAC SHA 256 solutions. They should all output <code>qnR8UCqJggD55PohusaBNviGoOJ67HC6Btry4qXLVZc=</code> given the values of <code>secret</code> and <code>Message</code>. Take notice of the capital M. The hashed message is case sensitive.</p>

<p>Jump to an implementation:</p>

<ul>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#js">Javascript</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#php">PHP</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#java">Java</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#groovy">Groovy</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#csharp">C#</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#objc">Objective C</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#go">Go</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#ruby">Ruby</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#python2">Python2</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#python3">Python3</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#perl">Perl</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#dart">Dart</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#swift">Swift</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#rust">Rust</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#powershell">Powershell</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#shell">Shell</a></li>
<li><a href="/blog/examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages#delphi">Delphi</a></li>
</ul>

<h3><a name='js'></a>Javascript HMAC SHA256</h3>

<p>Run the code online with this <a href="http://jsfiddle.net/af9ps1yk/6/">jsfiddle</a>.
Dependent upon an open source js library called <a href="http://code.google.com/p/crypto-js/">http://code.google.com/p/crypto-js/</a>.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/hmac-sha256.min.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/enc-base64.min.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>

<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
  <span class="kd">var</span> <span class="nx">hash</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="s2">&quot;Message&quot;</span><span class="p">,</span> <span class="s2">&quot;secret&quot;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">hashInBase64</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Base64</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">hash</span><span class="p">);</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">hashInBase64</span><span class="p">);</span>
<span class="o">&lt;</span><span class="err">/script&gt;</span>
</code></pre></div>
<h3><a name='php'></a>PHP HMAC SHA256</h3>

<p>PHP has built in methods for <a href="http://php.net/manual/en/function.hash-hmac.php">hash_hmac</a> (PHP 5) and <a href="http://php.net/manual/en/function.base64-encode.php">base64_encode</a> (PHP 4, PHP 5) resulting in no
outside dependencies. Say what you want about PHP but they have the cleanest code for this example.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="x">$s = hash_hmac(&#39;sha256&#39;, &#39;Message&#39;, &#39;secret&#39;, true);</span>
<span class="x">echo base64_encode($s);</span>
</code></pre></div>
<h3><a name='java'></a>Java HMAC SHA256</h3>

<p>Dependent on <a href="http://commons.apache.org/codec/">Apache Commons Codec</a> to encode in base64.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">javax.crypto.Mac</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.codec.binary.Base64</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiSecurityExample</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
     <span class="n">String</span> <span class="n">secret</span> <span class="o">=</span> <span class="s">&quot;secret&quot;</span><span class="o">;</span>
     <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">&quot;Message&quot;</span><span class="o">;</span>

     <span class="n">Mac</span> <span class="n">sha256_HMAC</span> <span class="o">=</span> <span class="n">Mac</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&quot;HmacSHA256&quot;</span><span class="o">);</span>
     <span class="n">SecretKeySpec</span> <span class="n">secret_key</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">SecretKeySpec</span><span class="o">(</span><span class="n">secret</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="s">&quot;HmacSHA256&quot;</span><span class="o">);</span>
     <span class="n">sha256_HMAC</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">secret_key</span><span class="o">);</span>

     <span class="n">String</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="na">encodeBase64String</span><span class="o">(</span><span class="n">sha256_HMAC</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">message</span><span class="o">.</span><span class="na">getBytes</span><span class="o">()));</span>
     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">hash</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Error&quot;</span><span class="o">);</span>
    <span class="o">}</span>
   <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<h3><a name='groovy'></a>Groovy HMAC SHA256</h3>

<p>It is mostly java code but there are some slight differences. Adapted from <a href="http://juliusgithaiga.blogspot.com/2013/06/hmacsha256-representation.html">Dev Takeout - Groovy HMAC/SHA256 representation</a>.</p>
<div class="highlight"><pre><code class="language-groovy" data-lang="groovy"><span class="kn">import</span> <span class="nn">javax.crypto.Mac</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.InvalidKeyException</span><span class="o">;</span>

<span class="kt">def</span> <span class="nf">hmac_sha256</span><span class="o">(</span><span class="n">String</span> <span class="n">secretKey</span><span class="o">,</span> <span class="n">String</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
 <span class="k">try</span> <span class="o">{</span>
    <span class="n">Mac</span> <span class="n">mac</span> <span class="o">=</span> <span class="n">Mac</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s2">&quot;HmacSHA256&quot;</span><span class="o">)</span>
    <span class="n">SecretKeySpec</span> <span class="n">secretKeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecretKeySpec</span><span class="o">(</span><span class="n">secretKey</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="s2">&quot;HmacSHA256&quot;</span><span class="o">)</span>
    <span class="n">mac</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">secretKeySpec</span><span class="o">)</span>
    <span class="kt">byte</span><span class="o">[]</span> <span class="n">digest</span> <span class="o">=</span> <span class="n">mac</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">getBytes</span><span class="o">())</span>
    <span class="k">return</span> <span class="n">digest</span>
   <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InvalidKeyException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s2">&quot;Invalid key exception while converting to HMac SHA256&quot;</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kt">def</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">hmac_sha256</span><span class="o">(</span><span class="s2">&quot;secret&quot;</span><span class="o">,</span> <span class="s2">&quot;Message&quot;</span><span class="o">)</span>
<span class="n">encodedData</span> <span class="o">=</span> <span class="n">hash</span><span class="o">.</span><span class="na">encodeBase64</span><span class="o">().</span><span class="na">toString</span><span class="o">()</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="n">encodedData</span><span class="o">)</span>
</code></pre></div>
<h3><a name='csharp'></a>C# HMAC SHA256</h3>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Test</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">class</span> <span class="nc">MyHmac</span>
  <span class="p">{</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="nf">CreateToken</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="kt">string</span> <span class="n">secret</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">secret</span> <span class="p">=</span> <span class="n">secret</span> <span class="p">??</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
      <span class="kt">var</span> <span class="n">encoding</span> <span class="p">=</span> <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">ASCIIEncoding</span><span class="p">();</span>
      <span class="kt">byte</span><span class="p">[]</span> <span class="n">keyByte</span> <span class="p">=</span> <span class="n">encoding</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">secret</span><span class="p">);</span>
      <span class="kt">byte</span><span class="p">[]</span> <span class="n">messageBytes</span> <span class="p">=</span> <span class="n">encoding</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
      <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">hmacsha256</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HMACSHA256</span><span class="p">(</span><span class="n">keyByte</span><span class="p">))</span>
      <span class="p">{</span>
        <span class="kt">byte</span><span class="p">[]</span> <span class="n">hashmessage</span> <span class="p">=</span> <span class="n">hmacsha256</span><span class="p">.</span><span class="n">ComputeHash</span><span class="p">(</span><span class="n">messageBytes</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">hashmessage</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3><a name='objc'></a>Objective C and Cocoa HMAC SHA256</h3>

<p>Most of the code required was for converting to bae64 and working the NSString and NSData data types.</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="cp">#import &quot;AppDelegate.h&quot;</span>
<span class="cp">#import &lt;CommonCrypto/CommonHMAC.h&gt;</span>

<span class="k">@implementation</span> <span class="nc">AppDelegate</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">applicationDidFinishLaunching:</span><span class="p">(</span><span class="bp">NSNotification</span> <span class="o">*</span><span class="p">)</span><span class="nv">aNotification</span> <span class="p">{</span>
 <span class="bp">NSString</span><span class="o">*</span> <span class="n">key</span> <span class="o">=</span> <span class="s">@&quot;secret&quot;</span><span class="p">;</span>
 <span class="bp">NSString</span><span class="o">*</span> <span class="n">data</span> <span class="o">=</span> <span class="s">@&quot;Message&quot;</span><span class="p">;</span>

 <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">cKey</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="nl">cStringUsingEncoding</span><span class="p">:</span><span class="n">NSASCIIStringEncoding</span><span class="p">];</span>
 <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">cData</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span> <span class="nl">cStringUsingEncoding</span><span class="p">:</span><span class="n">NSASCIIStringEncoding</span><span class="p">];</span>
 <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">cHMAC</span><span class="p">[</span><span class="n">CC_SHA256_DIGEST_LENGTH</span><span class="p">];</span>
 <span class="n">CCHmac</span><span class="p">(</span><span class="n">kCCHmacAlgSHA256</span><span class="p">,</span> <span class="n">cKey</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">cKey</span><span class="p">),</span> <span class="n">cData</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">cData</span><span class="p">),</span> <span class="n">cHMAC</span><span class="p">);</span>
 <span class="bp">NSData</span> <span class="o">*</span><span class="n">hash</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSData</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithBytes</span><span class="p">:</span><span class="n">cHMAC</span> <span class="nl">length</span><span class="p">:</span><span class="k">sizeof</span><span class="p">(</span><span class="n">cHMAC</span><span class="p">)];</span>

 <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;%@&quot;</span><span class="p">,</span> <span class="n">hash</span><span class="p">);</span>

 <span class="bp">NSString</span><span class="o">*</span> <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">AppDelegate</span> <span class="nl">base64forData</span><span class="p">:</span><span class="n">hash</span><span class="p">];</span>
 <span class="n">NSLog</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">+</span> <span class="p">(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span><span class="nf">base64forData:</span><span class="p">(</span><span class="bp">NSData</span><span class="o">*</span><span class="p">)</span><span class="nv">theData</span> <span class="p">{</span>
 <span class="k">const</span> <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">input</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span><span class="o">*</span><span class="p">)[</span><span class="n">theData</span> <span class="n">bytes</span><span class="p">];</span>
 <span class="bp">NSInteger</span> <span class="n">length</span> <span class="o">=</span> <span class="p">[</span><span class="n">theData</span> <span class="n">length</span><span class="p">];</span>

 <span class="k">static</span> <span class="kt">char</span> <span class="n">table</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span><span class="p">;</span>

 <span class="bp">NSMutableData</span><span class="o">*</span> <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSMutableData</span> <span class="nl">dataWithLength</span><span class="p">:((</span><span class="n">length</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span><span class="p">];</span>
 <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">output</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="n">data</span><span class="p">.</span><span class="n">mutableBytes</span><span class="p">;</span>

 <span class="bp">NSInteger</span> <span class="n">i</span><span class="p">;</span>
 <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
 <span class="bp">NSInteger</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="bp">NSInteger</span> <span class="n">j</span><span class="p">;</span>
 <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
 <span class="n">value</span> <span class="o">&lt;&lt;=</span> <span class="mi">8</span><span class="p">;</span>

 <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>  <span class="n">value</span> <span class="o">|=</span> <span class="p">(</span><span class="mh">0xFF</span> <span class="o">&amp;</span> <span class="n">input</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>  <span class="p">}</span>  <span class="p">}</span>  <span class="bp">NSInteger</span> <span class="n">theIndex</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span><span class="p">;</span>  <span class="n">output</span><span class="p">[</span><span class="n">theIndex</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">18</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
 <span class="n">output</span><span class="p">[</span><span class="n">theIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
 <span class="n">output</span><span class="p">[</span><span class="n">theIndex</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">length</span> <span class="o">?</span> <span class="n">table</span><span class="p">[(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">]</span> <span class="o">:</span> <span class="sc">&#39;=&#39;</span><span class="p">;</span>
 <span class="n">output</span><span class="p">[</span><span class="n">theIndex</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">length</span> <span class="o">?</span> <span class="n">table</span><span class="p">[(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">]</span> <span class="o">:</span> <span class="sc">&#39;=&#39;</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">return</span> <span class="p">[[</span><span class="bp">NSString</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithData</span><span class="p">:</span><span class="n">data</span> <span class="nl">encoding</span><span class="p">:</span><span class="n">NSASCIIStringEncoding</span><span class="p">];</span> <span class="p">}</span>

<span class="k">@end</span>
</code></pre></div>
<h3><a name='go'></a>Go programming language - Golang HMAC SHA256</h3>

<ul>
<li><a href="http://play.golang.org/p/iTmI0RUCkD">Try it online in your browser with Play GoLang</a></li>
<li><a href="http://golang.org/pkg/crypto/hmac/">crypto/hmac package</a></li>
</ul>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;crypto/hmac&quot;</span>
    <span class="s">&quot;crypto/sha256&quot;</span>
    <span class="s">&quot;encoding/base64&quot;</span>
    <span class="s">&quot;fmt&quot;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">ComputeHmac256</span><span class="p">(</span><span class="nx">message</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">secret</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="nx">key</span> <span class="o">:=</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">secret</span><span class="p">)</span>
    <span class="nx">h</span> <span class="o">:=</span> <span class="nx">hmac</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="nx">sha256</span><span class="p">.</span><span class="nx">New</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Write</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">message</span><span class="p">))</span>
    <span class="k">return</span> <span class="nx">base64</span><span class="p">.</span><span class="nx">StdEncoding</span><span class="p">.</span><span class="nx">EncodeToString</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">Sum</span><span class="p">(</span><span class="kc">nil</span><span class="p">))</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">ComputeHmac256</span><span class="p">(</span><span class="s">&quot;Message&quot;</span><span class="p">,</span> <span class="s">&quot;secret&quot;</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div>
<h3><a name='ruby'></a>Ruby HMAC SHA256</h3>

<p>Requires <a href="http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL.html">openssl</a> and <a href="http://ruby-doc.org/stdlib-2.0/libdoc/base64/rdoc/Base64.html">base64</a>.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">&#39;openssl&#39;</span>
<span class="nb">require</span> <span class="s2">&quot;base64&quot;</span>

<span class="nb">hash</span>  <span class="o">=</span> <span class="no">OpenSSL</span><span class="o">::</span><span class="no">HMAC</span><span class="o">.</span><span class="n">digest</span><span class="p">(</span><span class="s1">&#39;sha256&#39;</span><span class="p">,</span> <span class="s2">&quot;secret&quot;</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">)</span>
<span class="nb">puts</span> <span class="no">Base64</span><span class="o">.</span><span class="n">encode64</span><span class="p">(</span><span class="nb">hash</span><span class="p">)</span>
</code></pre></div>
<h3><a name='python2'></a>Python (2.7) HMAC SHA256</h3>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="n">message</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="s">&quot;Message&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="n">secret</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="s">&quot;secret&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>

<span class="n">signature</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span>
</code></pre></div>
<p>Tested with Python 2.7.6. Also, be sure not to name your python demo script the same as one of the imported libraries.</p>

<h3><a name='python3'></a>Python (3.7) HMAC SHA256</h3>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="n">message</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="s">&#39;Message&#39;</span><span class="p">,</span> <span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="n">secret</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="s">&#39;secret&#39;</span><span class="p">,</span> <span class="s">&#39;utf-8&#39;</span><span class="p">)</span>

<span class="n">signature</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span>
</code></pre></div>
<p>Tested with Python 3.7.0. Also, be sure not to name your python demo script the same as one of the imported libraries. Thanks to <a href="https://github.com/biswapanda">@biswapanda</a>.</p>

<h3><a name='perl'></a>Perl HMAC SHA256</h3>

<p>See <a href="http://search.cpan.org/%7Emshelor/Digest-SHA-5.85/lib/Digest/SHA.pm">Digest::SHA documentation</a>. By convention, the Digest modules do not pad their Base64 output. To fix this you can test the length of the hash and append equal signs &quot;=&quot; until it is the length is a multiple of 4. We will use a modulus function below.</p>
<div class="highlight"><pre><code class="language-perl" data-lang="perl"><span class="k">use</span> <span class="nn">Digest::</span><span class="n">SHA</span> <span class="sx">qw(hmac_sha256_base64)</span><span class="p">;</span>
<span class="nv">$digest</span> <span class="o">=</span> <span class="n">hmac_sha256_base64</span><span class="p">(</span><span class="s">&quot;Message&quot;</span><span class="p">,</span> <span class="s">&quot;secret&quot;</span><span class="p">);</span>

<span class="c1"># digest is currently: qnR8UCqJggD55PohusaBNviGoOJ67HC6Btry4qXLVZc</span>

<span class="c1"># Fix padding of Base64 digests</span>
<span class="k">while</span> <span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="nv">$digest</span><span class="p">)</span> <span class="nv">%</span> <span class="nv">4</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$digest</span> <span class="o">.=</span> <span class="s">&#39;=&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">print</span> <span class="nv">$digest</span><span class="p">;</span>
<span class="c1"># digest is now: qnR8UCqJggD55PohusaBNviGoOJ67HC6Btry4qXLVZc=</span>
</code></pre></div>
<h3><a name='dart'></a>Dart HMAC SHA256</h3>

<p>Dependent upon the Dart <a href="https://api.dartlang.org/docs/channels/stable/latest/crypto.html">crypto package</a>.</p>
<div class="highlight"><pre><code class="language-dart" data-lang="dart"><span class="k">import</span> <span class="s1">&#39;dart:html&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">&#39;dart:convert&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">&#39;package:crypto/crypto.dart&#39;</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>

  <span class="kt">String</span> <span class="n">secret</span> <span class="o">=</span> <span class="s1">&#39;secret&#39;</span><span class="p">;</span>
  <span class="kt">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Message&#39;</span><span class="p">;</span>

  <span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">secretBytes</span> <span class="o">=</span> <span class="n">UTF8</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;secret&#39;</span><span class="p">);</span>
  <span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">messageBytes</span> <span class="o">=</span> <span class="n">UTF8</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;Message&#39;</span><span class="p">);</span>

  <span class="kd">var</span> <span class="n">hmac</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HMAC</span><span class="p">(</span><span class="k">new</span> <span class="n">SHA256</span><span class="p">(),</span> <span class="n">secretBytes</span><span class="p">);</span>
  <span class="n">hmac</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">messageBytes</span><span class="p">);</span>
  <span class="kd">var</span> <span class="n">digest</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

  <span class="kd">var</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">CryptoUtils</span><span class="p">.</span><span class="n">bytesToBase64</span><span class="p">(</span><span class="n">digest</span><span class="p">);</span>

  <span class="c1">// output to html page</span>
  <span class="n">querySelector</span><span class="p">(</span><span class="s1">&#39;#hash&#39;</span><span class="p">).</span><span class="n">text</span> <span class="o">=</span> <span class="n">hash</span><span class="p">;</span>
  <span class="c1">// hash =&gt; qnR8UCqJggD55PohusaBNviGoOJ67HC6Btry4qXLVZc=</span>
<span class="p">}</span>
</code></pre></div>
<h3><a name='swift'></a>Swift HMAC SHA256</h3>

<p>I have not verified but see this <a href="http://stackoverflow.com/questions/24099520/commonhmac-in-swift">stackOverflow post</a></p>

<h3><a name='rust'></a>Rust</h3>

<p>Take a look at the <a href="https://github.com/alco/rust-digest/blob/master/hmac.rs">alco/rust-digest</a> repository for <a href="http://www.rust-lang.org/">Rust (lang)</a> guidance. I have not verified yet.</p>

<h3><a name='powershell'></a>Powershell (Windows) HMAC SHA256</h3>

<p>Mostly wrapping of .NET libraries but useful to see it in powershell&#39;s befuddling syntax. See code as <a href="https://gist.github.com/jokecamp/2c1a67b8f277797ecdb3">gist</a></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$message = &#39;Message&#39;
$secret = &#39;secret&#39;

$hmacsha = New-Object System.Security.Cryptography.HMACSHA256
$hmacsha.key = [Text.Encoding]::ASCII.GetBytes($secret)
$signature = $hmacsha.ComputeHash([Text.Encoding]::ASCII.GetBytes($message))
$signature = [Convert]::ToBase64String($signature)

echo $signature

# Do we get the expected signature?
echo ($signature -eq &#39;qnR8UCqJggD55PohusaBNviGoOJ67HC6Btry4qXLVZc=&#39;)
</code></pre></div>
<h3><a name='shell'></a>Shell (Bash etc) HMAC SHA256</h3>

<p>Using openssl. Credit to <a href="https://github.com/CzechJiri">@CzechJiri</a></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">MESSAGE=&quot;Message&quot;
SECRET=&quot;secret&quot;

echo -n $MESSAGE | openssl dgst -sha256 -hmac $SECRET -binary | base64
</code></pre></div>
<h3>### <a name='delphi'></a>Delphi HMAC SHA256</h3>

<p><a href="https://stackoverflow.com/a/40182566/215502">https://stackoverflow.com/a/40182566/215502</a></p>

</div>

<div class="tags">
Tags
 <div class='tag'><a href='/tag/#C#'>C#</a></div>  <div class='tag'><a href='/tag/#powershell'>powershell</a></div>  <div class='tag'><a href='/tag/#dart'>dart</a></div>  <div class='tag'><a href='/tag/#go'>go</a></div>  <div class='tag'><a href='/tag/#hmac'>hmac</a></div>  <div class='tag'><a href='/tag/#java'>java</a></div>  <div class='tag'><a href='/tag/#javascript'>javascript</a></div>  <div class='tag'><a href='/tag/#objectiveC'>objectiveC</a></div>  <div class='tag'><a href='/tag/#perl'>perl</a></div>  <div class='tag'><a href='/tag/#php'>php</a></div>  <div class='tag'><a href='/tag/#python2'>python2</a></div>  <div class='tag'><a href='/tag/#python3'>python3</a></div>  <div class='tag'><a href='/tag/#rest'>rest</a></div>  <div class='tag'><a href='/tag/#ruby'>ruby</a></div>  <div class='tag'><a href='/tag/#security'>security</a></div>  <div class='tag'><a href='/tag/#sha256'>sha256</a></div>  <div class='tag'><a href='/tag/#swift'>swift</a></div>  <div class='tag'><a href='/tag/#shell'>shell</a></div> 
</div>

<div class="post-footer">
  Notice a typo or something incorrect?<br>
  Leave a comment or submit changes via <a href="https://github.com/jokecamp/jokecamp.com/tree/master/_posts/2012-10-22-examples-of-creating-base64-hashes-using-hmac-sha256-in-different-languages.markdown">GitHub</a>.
</div>

      </div>

      <div class="footer" role="contentinfo">
        <ul>
          <li><a href="/atom.xml" title="Atom Feed">Atom Feed</a></li>
          <li><a href="/rss.xml" title="RSS Feed">RSS Feed</a></li>
          <li><a href="https://github.com/jokecamp/jokecamp.com/" title="View Source on GitHub">View Source</a></li>
          <li><a href="mailto:joe.kampschmidt@gmail.com" title="email me">Contact me</a></li>
        </ul>
      </div>

    </div> <!-- end container -->

  </body>
</html>
